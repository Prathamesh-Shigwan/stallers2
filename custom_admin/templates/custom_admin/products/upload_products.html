{% extends "custom_admin/base_site.html" %}

{% block content %}
<div class="container mt-4">
    <h2>Bulk Upload Products</h2>
    <p class="text-muted mb-3">
        Please upload an Excel file with the following columns:<br>
        <strong>Main Category</strong>, <strong>Sub Category</strong>, <strong>Product Name</strong>, <strong>Product Title</strong>, <strong>Description</strong>, <strong>Specification</strong>, <strong>Product Status</strong>, <strong>Status</strong>, <strong>In Stock</strong>, <strong>Featured</strong>, <strong>SKU (Optional)</strong>
    </p>

    <form method="post" enctype="multipart/form-data" class="p-4 border rounded shadow-sm bg-light">
        {% csrf_token %}
        <div class="mb-3">
            <label for="excel_file" class="form-label">Upload Excel File (.xlsx)</label>
            <input type="file" name="excel_file" id="excel_file" accept=".xlsx" required class="form-control">
            <small id="file-name" class="form-text text-muted">No file selected</small>
        </div>
        <button type="submit" class="btn btn-primary">Upload</button>
        <a href="{% url 'custom_admin:product_list' %}" class="btn btn-secondary">Back to Product List</a>
    </form>
</div>

<script>
    document.getElementById('excel_file').addEventListener('change', function() {
        const fileName = this.files[0] ? this.files[0].name : 'No file selected';
        document.getElementById('file-name').innerText = fileName;
    });
</script>
{% endblock %}
